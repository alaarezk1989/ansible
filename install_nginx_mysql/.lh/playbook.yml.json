{
    "sourceFile": "playbook.yml",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 5,
            "patches": [
                {
                    "date": 1713559811312,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1713563607358,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -94,8 +94,9 @@\n       mysql_db:\n         name: ecomdb\n         state: present\n         login_user: root\n+        login_unix_socket: /var/run/mysqld/mysqld.sock\n \n     - name: Create database user with name 'ecomuser' and password 'ecompassword' with all database privileges\n       mysql_user:\n         name: ecomuser\n"
                },
                {
                    "date": 1713563732648,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -64,10 +64,9 @@\n \n \n \n - name: install and configure Mysql\n-  hosts: web\n-  become: true\n+jenkins_slave  become: true\n   vars_files:\n     - vars/default.yml\n   tasks:\n   # MySQL Configuration\n"
                },
                {
                    "date": 1713563763260,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -64,9 +64,10 @@\n \n \n \n - name: install and configure Mysql\n-jenkins_slave  become: true\n+  hosts: jenkins_slave\n+  become: true\n   vars_files:\n     - vars/default.yml\n   tasks:\n   # MySQL Configuration\n@@ -93,9 +94,8 @@\n       mysql_db:\n         name: ecomdb\n         state: present\n         login_user: root\n-        login_unix_socket: /var/run/mysqld/mysqld.sock\n \n     - name: Create database user with name 'ecomuser' and password 'ecompassword' with all database privileges\n       mysql_user:\n         name: ecomuser\n"
                },
                {
                    "date": 1713563894957,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -82,8 +82,9 @@\n         name: ''\n         host_all: yes\n         state: absent\n         login_user: root\n+        login_password: \"{{ mysql_root_password }}\"\n \n     - name: Removes the MySQL test database\n       mysql_db: \n         name: test \n"
                },
                {
                    "date": 1713564016099,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -89,14 +89,16 @@\n       mysql_db: \n         name: test \n         state: absent\n         login_user: root\n+        login_password: \"{{ mysql_root_password }}\"\n \n     - name: Create a new database with name 'ecomdb'\n       mysql_db:\n         name: ecomdb\n         state: present\n         login_user: root\n+        login_password: \"{{ mysql_root_password }}\"\n \n     - name: Create database user with name 'ecomuser' and password 'ecompassword' with all database privileges\n       mysql_user:\n         name: ecomuser\n"
                }
            ],
            "date": 1713559811312,
            "name": "Commit-0",
            "content": "- name: install and configure Nginx\n  hosts: jenkins_slave\n  become: true\n  vars_files:\n    - vars/default.yml\n  tasks:\n    - name: Install Prerequisites\n      apt: \n        name: \"{{ item }}\" \n        update_cache: yes\n        state: latest\n        force_apt_get: yes\n      loop: [ 'aptitude' ]\n\n    - name: Install LEMP Packages\n      apt: \n        name: \"{{ item }}\"\n        update_cache: yes \n        state: latest\n      loop: [ 'nginx', 'mysql-server', 'python3-pymysql', 'php-fpm', 'php-mysql' ]\n    \n    # Nginx Configuration\n    - name: Sets Nginx conf file\n      template:\n        src: \"templates/nginx.conf.j2\"\n        dest: \"/etc/nginx/sites-available/{{ http_conf }}\"\n\n    - name: Enables new site\n      file:\n        src: \"/etc/nginx/sites-available/{{ http_conf }}\"\n        dest: \"/etc/nginx/sites-enabled/{{ http_conf }}\"\n        state: link\n      notify: Reload Nginx\n    \n    - name: Removes \"default\" site\n      file:\n        path: \"/etc/nginx/sites-enabled/default\"\n        state: absent\n      notify: Reload Nginx\n\n# UFW Configuration\n    - name: \"UFW - Allow HTTP on port {{ http_port }}\"\n      ufw:\n        rule: allow\n        port: \"{{ http_port }}\"\n        proto: tcp\n\n  # Sets Up PHP Info Page\n    - name: Sets Up PHP Info Page\n      template:\n        src: \"templates/info.php.j2\"\n        dest: \"/var/www/html/info.php\"\n\n  handlers:\n      - name: Reload Nginx\n        service:\n          name: nginx\n          state: reloaded\n\n      - name: Restart Nginx\n        service:\n          name: nginx\n          state: restarted\n\n\n\n- name: install and configure Mysql\n  hosts: web\n  become: true\n  vars_files:\n    - vars/default.yml\n  tasks:\n  # MySQL Configuration\n    - name: Sets the root password \n      mysql_user: \n        name: root \n        password: \"{{ mysql_root_password }}\"\n        login_unix_socket: /var/run/mysqld/mysqld.sock\n\n    - name: Removes all anonymous user accounts\n      mysql_user:\n        name: ''\n        host_all: yes\n        state: absent\n        login_user: root\n\n    - name: Removes the MySQL test database\n      mysql_db: \n        name: test \n        state: absent\n        login_user: root\n\n    - name: Create a new database with name 'ecomdb'\n      mysql_db:\n        name: ecomdb\n        state: present\n        login_user: root\n\n    - name: Create database user with name 'ecomuser' and password 'ecompassword' with all database privileges\n      mysql_user:\n        name: ecomuser\n        host_all: yes\n        password: ecompassword\n        priv: '*.*:ALL'\n        state: present\n        login_user: root\n\n    - name: Copy database dump file\n      copy:\n        src: dbsql.sql\n        dest: /tmp\n\n    - name: Restore database\n      mysql_db:\n        name: ecomdb\n        state: import\n        target: /tmp/dbsql.sql\n        login_user: root\n\n"
        }
    ]
}